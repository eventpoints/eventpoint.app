{% extends 'base.html.twig' %}

{% block body %}
    <div class="container">
        <div class="row justify-content-center mt-3">
            <div class="col-12 col-md-4">
                <div class="card">
                    {{ include('partials/_account-navbar.html.twig') }}
                </div>
            </div>
            <div class="col-12 col-md-8">
                <div class="row justify-content-start my-3">
                    <div class="fs-3 fw-bold text-end">{{ 'upcoming-events'|trans|upper }}</div>
                    <hr/>
                    {% for event in events %}
                        <div class="col-12 col-md-6">
                            <div class="card position-relative" {{ stimulus_target('dynamic-map', 'event-card') }}>
                                {% if event.eventGroup %}
                                    <a href="{{ path('show_event_group', {id: event.eventGroup.id }) }}">
                                        <div class="position-absolute top-0 mt-2 ms-2 badge rounded-pill bg-warning">
                                            {{ event.eventGroup.title }}
                                        </div>
                                    </a>
                                {% endif %}
                                {% if event.base64Image %}
                                    <img src="{{ event.base64Image }}" class="card-img-top object-fit-cover"
                                         height="150px"
                                         alt="{{ event.title }}">
                                {% endif %}
                                <div class="card-body rounded-top">
                                    <div class="fw-bold h5 {{ event.isComplete('Europe/Prague') ? 'text-decoration-line-through' : '' }}">
                                        <a href="{{ path('show_event', {id: event.id}) }}">
                                            {{ event.title }}
                                        </a>
                                    </div>
                                    <div class="d-flex justify-content-start fw-bold">
                                        <div class="me-1">{{ event.startAt|format_date(pattern='d.M') }}  {{ event.startAt|format_time(timeFormat='short',pattern='H:mm',timezone='Europe/Prague') }}</div>
                                        <div class="me-1"> -</div>
                                        <div>{{ event.endAt|format_date(pattern='d.M') }}  {{ event.endAt|format_time(timeFormat='short',pattern='H:mm',timezone='Europe/Prague') }}</div>
                                    </div>
                                </div>
                                {% if event.isInProgress('Europe/Prague') %}
                                    <div {{ stimulus_controller('progress', {
                                        elapsed: event.elapsedTimeInMinutes,
                                        duration: event.durationInMinutes
                                    }) }}>
                                        <div class="progress rounded-0" style="height:5px" data-bs-toggle="tooltip"
                                             data-bs-placement="top"
                                             data-bs-title="{{ event.timeRemainingAsInterval }} {{ 'remaining'|trans }}">
                                            <div {{ stimulus_target('progress', 'progressBar') }}
                                                    class="progress-bar bg-success" role="progressbar"
                                                    aria-valuenow="0"
                                                    aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                {% elseif event.isComplete('Europe/Prague') %}
                                    <div class="progress rounded-0" style="height:3px" role="progressbar"
                                         aria-label="Basic example" aria-valuenow="0" aria-valuemin="0"
                                         aria-valuemax="100">
                                        <div class="progress-bar bg-success" style="width: 100%"></div>
                                    </div>
                                {% else %}
                                    <div class="progress rounded-0" style="height:3px" role="progressbar"
                                         aria-label="Basic example" aria-valuenow="0" aria-valuemin="0"
                                         aria-valuemax="100">
                                        <div class="progress-bar" style="width: 0"></div>
                                    </div>
                                {% endif %}
                                <div class="card-body d-flex justify-content-start flex-wrap">
                                    {% for category in event.categories %}
                                        <span class="badge rounded-pill text-bg-light fs-6 me-1 mb-1">{{ category.title|trans }}</span>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}